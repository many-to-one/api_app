{% extends 'base.html' %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

{% block content %}
<body>

    <div class="offers__cont" id="offers__cont">

        <div class="list__header_orders">

        </div>

        <div id="messageBox" class="message-box" style="display: none;">
            <span id="messageText"></span>
            <button id="closeButton" class="close-button" onclick="closeMessage()">&times;</button>
        </div>

        <h3>Zwroty</h3>

        <div id="offersContainer" style="width: 100%;">

            {% for return in result.customerReturns %}
            
                <div class="offers__line show">

                    {% for item in return.items %}

                    <div class="d-flex flex-column w-100">


                        <div class="d-flex justify-content-between">

                            <div class="d-flex flex-column">
                                <p>Numer zwrotu</p>
                                <p>{{ return.referenceNumber }}</p>
                            </div>

                            <div class="d-flex flex-column">
                                <p>{{ return.buyer.login }}</p>
                                <p>{{ return.refund.bankAccount.owner }}</p>
                            </div>

                            <div class="d-flex flex-column mb-3">
                                <p>Rynek</p>
                                <p>{{ return.marketplaceId }}</p>
                            </div>

                            <div class="d-flex flex-column mb-3">
                                <p>Data zwrotu</p>
                                <p>{{ return.createdAt }}</p>
                            </div>

                            <div class="d-flex flex-column mb-3">
                                <p>{{ return.status }}</p>
                                <p>{{ return.parcels.0.carrierId }}</p>
                            </div>

                        </div>

                        <hr>

                        <div class="d-flex justify-content-between">

                            <div class="name_offer">
                                <a href="{{ item.url }}">{{ item.name }}</a>
                                <p>{{ item.offerId }}</p>
                                <p>{{ item.reason.type }}</p>
                                <p>{{ item.reason.userComment }}</p>                               
                            </div>

                            <p>{{ item.quantity }} szt</p>
                            <p>{{ item.price.amount }} {{ item.price.currency }}</p>

                        </div>

                        <hr id="hr_{{ forloop.counter }}" style="display: none;">

                        <div 
                            id="returnDetails_{{ forloop.counter }}" 
                            class="d-flex justify-content-between"
                            style="height: 0px; opacity: 0;"
                        >
                            
                            <div 
                                class="d-flex flex-column" 
                                id="customerData_{{ forloop.counter }}"
                                style="margin-top: -10vh;"
                            >
                                <p>Dane kupującego</p>
                                <p>{{ return.refund.bankAccount.owner }}</p>
                                <p>{{ return.parcels.0.sender.phoneNumber }}</p>
                            </div>

                            <div class="d-flex flex-column">
                                <p>Metoda dostawy</p>
                                <p>{{ return.parcels.0.carrierId }}</p>
                                <p>{{ return.parcels.0.waybill }}</p>
                            </div>

                            <div class="d-flex flex-column">
                                <p>Zwrot środków</p>
                                <p>{{ return.refund.bankAccount.owner }}</p>
                                <p>{{ return.refund.bankAccount.accountNumber }}</p>
                                <p>{{ return.refund.bankAccount.address.street }}</p>
                                <p>{{ return.refund.bankAccount.address.city }}</p>
                                <p>{{ return.refund.bankAccount.address.postCode }}</p>
                                <p>{{ return.refund.bankAccount.address.countryCode }}</p>
                            </div>

                        </div>

                        <hr>

                        <div class="d-flex justify-content-between">

                            <p 
                                onclick="getDetails('{{ forloop.counter }}')" 
                                id="showDetails_{{ forloop.counter }}"
                                style="cursor: pointer;"
                                class="btn-link"
                            >
                                Pokaż szczegóły
                            </p>

                            <div class="d-flex justify-content-end g-10">
                                <p style="cursor: pointer;" class="btn-link">Zamówienie</p>
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chat-dots" viewBox="0 0 16 16">
                                    <path d="M5 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0m4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0m3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2"/>
                                    <path d="m2.165 15.803.02-.004c1.83-.363 2.948-.842 3.468-1.105A9 9 0 0 0 8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6a10.4 10.4 0 0 1-.524 2.318l-.003.011a11 11 0 0 1-.244.637c-.079.186.074.394.273.362a22 22 0 0 0 .693-.125m.8-3.108a1 1 0 0 0-.287-.801C1.618 10.83 1 9.468 1 8c0-3.192 3.004-6 7-6s7 2.808 7 6-3.004 6-7 6a8 8 0 0 1-2.088-.272 1 1 0 0 0-.711.074c-.387.196-1.24.57-2.634.893a11 11 0 0 0 .398-2"/>
                                </svg>
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-cash-coin" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M11 15a4 4 0 1 0 0-8 4 4 0 0 0 0 8m5-4a5 5 0 1 1-10 0 5 5 0 0 1 10 0"/>
                                <path d="M9.438 11.944c.047.596.518 1.06 1.363 1.116v.44h.375v-.443c.875-.061 1.386-.529 1.386-1.207 0-.618-.39-.936-1.09-1.1l-.296-.07v-1.2c.376.043.614.248.671.532h.658c-.047-.575-.54-1.024-1.329-1.073V8.5h-.375v.45c-.747.073-1.255.522-1.255 1.158 0 .562.378.92 1.007 1.066l.248.061v1.272c-.384-.058-.639-.27-.696-.563h-.668zm1.36-1.354c-.369-.085-.569-.26-.569-.522 0-.294.216-.514.572-.578v1.1zm.432.746c.449.104.655.272.655.569 0 .339-.257.571-.709.614v-1.195z"/>
                                <path d="M1 0a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h4.083q.088-.517.258-1H3a2 2 0 0 0-2-2V3a2 2 0 0 0 2-2h10a2 2 0 0 0 2 2v3.528c.38.34.717.728 1 1.154V1a1 1 0 0 0-1-1z"/>
                                <path d="M9.998 5.083 10 5a2 2 0 1 0-3.132 1.65 6 6 0 0 1 3.13-1.567"/>
                                </svg>
                            </div>

                        </div>


                    </div>

                    {% endfor %}
                </div>

            {% endfor %}

        </div>

    </div>




    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.8/axios.min.js"></script>

    <script>

        function getDetails(index) {

            var showDetails = document.getElementById('showDetails_' + index);
            var returnDetails = document.getElementById('returnDetails_' + index);
            var customerData = document.getElementById('customerData_' + index);
            var hrElement = document.getElementById('hr_' + index);

            if ( returnDetails.style.height === '0px' ) {
                showDetails.textContent = 'Ukryj szczególy';
                returnDetails.style.height = 'auto';
                returnDetails.style.opacity = '1';
                customerData.style.marginTop = '0vh'; 
                hrElement.style.display = 'block';
            } else {
                showDetails.textContent = 'Pokaż szczególy';
                returnDetails.style.height = '0px';
                returnDetails.style.opacity = '0';
                customerData.style.marginTop = '-10vh'; 
                hrElement.style.display = 'none';
            }
        }

    </script>

</body>

{% endblock %}
</html>